"use strict";(function(n){n.vakata={},n.vakata.css={get_css:function(n,t,i){n=n.toLowerCase();var u=i.cssRules||i.rules,r=0;do{if(u.length&&r>u.length+5)return!1;if(u[r].selectorText&&u[r].selectorText.toLowerCase()==n)return t===!0?(i.removeRule&&i.removeRule(r),i.deleteRule&&i.deleteRule(r),!0):u[r]}while(u[++r]);return!1},add_css:function(t,i){return n.jstree.css.get_css(t,!1,i)?!1:(i.insertRule?i.insertRule(t+" { }",0):i.addRule(t,null,0),n.vakata.css.get_css(t))},remove_css:function(t,i){return n.vakata.css.get_css(t,!0,i)},add_sheet:function(t){var i;if(t.str){if(i=document.createElement("style"),i.setAttribute("type","text/css"),i.styleSheet)try{document.getElementsByTagName("head")[0].appendChild(i),i.styleSheet.cssText=t.str}catch(r){n("head").append('<style type="text/css">'+t.str+"<\/style>")}else i.appendChild(document.createTextNode(t.str)),document.getElementsByTagName("head")[0].appendChild(i);return i.sheet||i.styleSheet}if(t.url)if(document.createStyleSheet)try{i=document.createStyleSheet(t.url)}catch(r){}else return i=document.createElement("link"),i.rel="stylesheet",i.type="text/css",i.media="all",i.href=t.url,document.getElementsByTagName("head")[0].appendChild(i),i.styleSheet}}})(jQuery),function(n){var t=[],r=-1,u={},i={},f=!1;n.fn.jstree=function(i){var r=typeof i=="string",f=Array.prototype.slice.call(arguments,1),e=this;return(!r&&n.meta&&f.push(n.metadata.get(this).jstree),i=!r&&f.length?n.extend.apply(null,[!0,i].concat(f)):i,r&&i.substring(0,1)=="_")?e:(r?this.each(function(){var r=t[n.data(this,"jstree-instance-id")],u=r&&n.isFunction(r[i])?r[i].apply(r,f):r;if(typeof u!="undefined"&&(i.indexOf(!1)||u!==!0&&u!==!1))return e=u,!1}):this.each(function(){var r=n.data(this,"jstree-instance-id"),f=!1;typeof r!="undefined"&&t[r]&&t[r].destroy(),r=parseInt(t.push({}),10)-1,n.data(this,"jstree-instance-id",r),i||(i={}),i.plugins=n.isArray(i.plugins)?i.plugins:n.jstree.defaults.plugins,n.inArray("core",i.plugins)===-1&&i.plugins.unshift("core"),f=n.extend(!0,{},n.jstree.defaults,i),f.plugins=i.plugins,n.each(u,function(t){n.inArray(t,f.plugins)===-1&&(f[t]=null,delete f[t])}),t[r]=new n.jstree._instance(r,n(this).addClass("jstree jstree-"+r),f),n.each(t[r]._get_settings().plugins,function(n,i){t[r].data[i]={}}),n.each(t[r]._get_settings().plugins,function(n,i){u[i]&&u[i].__init.apply(t[r])}),t[r].init(),n(this).trigger("init_done.jstree")}),e)},n.jstree={defaults:{plugins:[]},_focused:function(){return t[r]||null},_reference:function(i){if(t[i])return t[i];var r=n(i);return(r.length||typeof i!="string"||(r=n("#"+i)),!r.length)?null:t[r.closest(".jstree").data("jstree-instance-id")]||null},_instance:function(t,i,r){this.data={core:{}},this.get_settings=function(){return n.extend(!0,{},r)},this._get_settings=function(){return r},this.get_index=function(){return t},this.get_container=function(){return i},this._set_settings=function(t){r=n.extend(!0,{},r,t)}},_fn:{},plugin:function(t,i){i=n.extend({},{__init:n.noop,__destroy:n.noop,_fn:{},defaults:!1},i),u[t]=i,n.jstree.defaults[t]=i.defaults,n.each(i._fn,function(i,r){r.plugin=t,r.old=n.jstree._fn[i],n.jstree._fn[i]=function(){var f,t=r,u=Array.prototype.slice.call(arguments),o=new n.Event("before.jstree"),e=!1;do{if(t&&t.plugin&&n.inArray(t.plugin,this._get_settings().plugins)!==-1)break;t=t.old}while(t);if(t)return(f=this.get_container().triggerHandler(o,{func:i,inst:this,args:u}),f===!1)?void 0:(typeof f!="undefined"&&(u=f),i.indexOf("_")===0?t.apply(this,u):t.apply(n.extend({},this,{__callback:function(n){this.get_container().triggerHandler(i+".jstree",{inst:this,args:u,rslt:n,rlbk:e})},__rollback:function(){return e=this.get_rollback()},__call_old:function(n){return t.old.apply(this,n?Array.prototype.slice.call(arguments,1):u)}}),u))},n.jstree._fn[i].old=r.old,n.jstree._fn[i].plugin=t})},rollback:function(i){i&&(n.isArray(i)||(i=[i]),n.each(i,function(n,i){t[i.i].set_rollback(i.h,i.d)}))}},n.jstree._fn=n.jstree._instance.prototype={},n(function(){var t=navigator.userAgent.toLowerCase(),r=(t.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],i=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";/msie/.test(t)&&parseInt(r,10)==6&&(f=!0,i+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "),/msie/.test(t)&&parseInt(r,10)==7&&(i+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "),n.vakata.css.add_sheet({str:i})}),n.jstree.plugin("core",{__init:function(){this.data.core.to_open=n.map(n.makeArray(this.get_settings().core.initially_open),function(n){return"#"+n.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")})},defaults:{html_titles:!1,animation:500,initially_open:[],rtl:!1,strings:{loading:"Loading ...",new_node:"New node"}},_fn:{init:function(){this.set_focus(),this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl"),this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;<\/ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;<\/ins>"+this._get_settings().core.strings.loading+"<\/a><\/li><\/ul>"),this.data.core.li_height=this.get_container().find("ul li.jstree-closed, ul li.jstree-leaf").eq(0).height()||18,this.get_container().delegate("li > ins","click.jstree",n.proxy(function(t){var i=n(t.target);i.is("ins")&&t.pageY-i.offset().top<this.data.core.li_height&&this.toggle_node(i)},this)).bind("mousedown.jstree",n.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(){var n;if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){n=window.getSelection();try{n.removeAllRanges(),n.collapse()}catch(t){}}}),this.__callback(),this.load_node(-1,function(){this.loaded(),this.reopen()})},destroy:function(){var i,f=this.get_index(),e=this._get_settings(),o=this;if(n.each(e.plugins,function(n,t){try{u[t].__destroy.apply(o)}catch(i){}}),this.__callback(),this.is_focused())for(i in t)if(t.hasOwnProperty(i)&&i!=f){t[i].set_focus();break}f===r&&(r=-1),this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree-instance-id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")}),t[f]=null,delete t[f]},save_opened:function(){var n=this;this.data.core.to_open=[],this.get_container().find(".jstree-open").each(function(){n.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/"))}),this.__callback(n.data.core.to_open)},reopen:function(t){var r=this,f=!0,i=[],u=[];t||(this.data.core.reopen=!1,this.data.core.refreshing=!0),this.data.core.to_open.length&&(n.each(this.data.core.to_open,function(t,r){if(r=="#")return!0;n(r).length&&n(r).is(".jstree-closed")?i.push(r):u.push(r)}),i.length&&(this.data.core.to_open=u,n.each(i,function(n,t){r.open_node(t,function(){r.reopen(!0)},!0)}),f=!1))},refresh:function(n){var t=this;this.save_opened(),n||(n=-1),n=this._get_node(n),n||(n=-1),n!==-1&&n.children("UL").remove(),this.load_node(n,function(){t.__callback({obj:n}),t.reopen()})},loaded:function(){this.__callback()},set_focus:function(){var t=n.jstree._focused();t&&t!==this&&t.get_container().removeClass("jstree-focused"),t!==this&&(this.get_container().addClass("jstree-focused"),r=this.get_index()),this.__callback()},is_focused:function(){return r==this.get_index()},_get_node:function(t){var i=n(t,this.get_container());return i.is(".jstree")||t==-1?-1:(i=i.closest("li",this.get_container()),i.length?i:!1)},_get_next:function(n,t){return(n=this._get_node(n),n===-1)?this.get_container().find("> ul > li:first-child"):n.length?t?n.nextAll("li").size()>0?n.nextAll("li:eq(0)"):!1:n.hasClass("jstree-open")?n.find("li:eq(0)"):n.nextAll("li").size()>0?n.nextAll("li:eq(0)"):n.parentsUntil(".jstree","li").next("li").eq(0):!1},_get_prev:function(n,t){if(n=this._get_node(n),n===-1)return this.get_container().find("> ul > li:last-child");if(!n.length)return!1;if(t)return n.prevAll("li").length>0?n.prevAll("li:eq(0)"):!1;if(n.prev("li").length){for(n=n.prev("li").eq(0);n.hasClass("jstree-open");)n=n.children("ul:eq(0)").children("li:last");return n}var i=n.parentsUntil(".jstree","li:eq(0)");return i.length?i:!1},_get_parent:function(n){if(n=this._get_node(n),n==-1||!n.length)return!1;var t=n.parentsUntil(".jstree","li:eq(0)");return t.length?t:-1},_get_children:function(n){return(n=this._get_node(n),n===-1)?this.get_container().children("ul:eq(0)").children("li"):n.length?n.children("ul:eq(0)").children("li"):!1},get_path:function(n,t){var i=[],r=this;return(n=this._get_node(n),n===-1||!n||!n.length)?!1:(n.parentsUntil(".jstree","li").each(function(){i.push(t?this.id:r.get_text(this))}),i.reverse(),i.push(t?n.attr("id"):this.get_text(n)),i)},is_open:function(n){return n=this._get_node(n),n&&n!==-1&&n.hasClass("jstree-open")},is_closed:function(n){return n=this._get_node(n),n&&n!==-1&&n.hasClass("jstree-closed")},is_leaf:function(n){return n=this._get_node(n),n&&n!==-1&&n.hasClass("jstree-leaf")},open_node:function(n,t,i){if(n=this._get_node(n),!n.length)return!1;if(!n.hasClass("jstree-closed"))return t&&t.call(),!1;var r=i||f?0:this._get_settings().core.animation,u=this;this._is_loaded(n)?(r&&n.children("ul").css("display","none"),n.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),r&&n.children("ul").stop(!0).slideDown(r,function(){this.style.display=""}),this.__callback({obj:n}),t&&t.call()):(n.children("a").addClass("jstree-loading"),this.load_node(n,function(){u.open_node(n,t,i)},t))},close_node:function(n,t){n=this._get_node(n);var i=t||f?0:this._get_settings().core.animation;if(!n.length||!n.hasClass("jstree-open"))return!1;i&&n.children("ul").attr("style","display:block !important"),n.removeClass("jstree-open").addClass("jstree-closed"),i&&n.children("ul").stop(!0).slideUp(i,function(){this.style.display=""}),this.__callback({obj:n})},toggle_node:function(n){return(n=this._get_node(n),n.hasClass("jstree-closed"))?this.open_node(n):n.hasClass("jstree-open")?this.close_node(n):void 0},open_all:function(n,t){n=n?this._get_node(n):this.get_container(),n&&n!==-1||(n=this.get_container()),t?n=n.find("li.jstree-closed"):(t=n,n=n.is(".jstree-closed")?n.find("li.jstree-closed").andSelf():n.find("li.jstree-closed"));var i=this;n.each(function(){var n=this;i._is_loaded(this)?i.open_node(this,!1,!0):i.open_node(this,function(){i.open_all(n,t)},!0)}),t.find("li.jstree-closed").length===0&&this.__callback({obj:t})},close_all:function(n){var t=this;n=n?this._get_node(n):this.get_container(),n&&n!==-1||(n=this.get_container()),n.find("li.jstree-open").andSelf().each(function(){t.close_node(this)}),this.__callback({obj:n})},clean_node:function(t){t=t&&t!=-1?n(t):this.get_container(),t=t.is("li")?t.find("li").andSelf():t.find("li"),t.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed"),t.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove(),this.__callback({obj:t})},get_rollback:function(){return this.__callback(),{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(n,t){this.get_container().empty().append(n),this.data=t,this.__callback()},load_node:function(n){this.__callback({obj:n})},_is_loaded:function(){return!0},create_node:function(t,i,r,u,f){t=this._get_node(t),i=typeof i=="undefined"?"last":i;var o=n("<li>"),s=this._get_settings().core,e;if(t!==-1&&!t.length)return!1;if(!f&&!this._is_loaded(t))return this.load_node(t,function(){this.create_node(t,i,r,u,!0)}),!1;this.__rollback(),typeof r=="string"&&(r={data:r}),r||(r={}),r.attr&&o.attr(r.attr),r.state&&o.addClass("jstree-"+r.state),r.data||(r.data=s.strings.new_node),n.isArray(r.data)||(e=r.data,r.data=[],r.data.push(e)),n.each(r.data,function(t,i){e=n("<a>"),n.isFunction(i)&&(i=i.call(this,r)),typeof i=="string"?e.attr("href","#")[s.html_titles?"html":"text"](i):(i.attr||(i.attr={}),i.attr.href||(i.attr.href="#"),e.attr(i.attr)[s.html_titles?"html":"text"](i.title),i.language&&e.addClass(i.language)),e.prepend("<ins class='jstree-icon'>&#160;<\/ins>"),i.icon&&(i.icon.indexOf("/")===-1?e.children("ins").addClass(i.icon):e.children("ins").css("background","url('"+i.icon+"') center center no-repeat")),o.append(e)}),o.prepend("<ins class='jstree-icon'>&#160;<\/ins>"),t===-1&&(t=this.get_container(),i==="before"&&(i="first"),i==="after"&&(i="last"));switch(i){case"before":t.before(o),e=this._get_parent(t);break;case"after":t.after(o),e=this._get_parent(t);break;case"inside":case"first":t.children("ul").length||t.append("<ul>"),t.children("ul").prepend(o),e=t;break;case"last":t.children("ul").length||t.append("<ul>"),t.children("ul").append(o),e=t;break;default:t.children("ul").length||t.append("<ul>"),i||(i=0),e=t.children("ul").children("li").eq(i),e.length?e.before(o):t.children("ul").append(o),e=t}return(e===-1||e.get(0)===this.get_container().get(0))&&(e=-1),this.clean_node(e),this.__callback({obj:o,parent:e}),u&&u.call(this,o),o},get_text:function(n){if(n=this._get_node(n),!n.length)return!1;var t=this._get_settings().core.html_titles;return n=n.children("a:eq(0)"),t?(n=n.clone(),n.children("INS").remove(),n.html()):(n=n.contents().filter(function(){return this.nodeType==3})[0],n.nodeValue)},set_text:function(n,t){if(n=this._get_node(n),!n.length)return!1;if(n=n.children("a:eq(0)"),this._get_settings().core.html_titles){var i=n.children("INS").clone();return n.html(t).prepend(i),this.__callback({obj:n,name:t}),!0}return n=n.contents().filter(function(){return this.nodeType==3})[0],this.__callback({obj:n,name:t}),n.nodeValue=t},rename_node:function(n,t){n=this._get_node(n),this.__rollback(),n&&n.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))&&this.__callback({obj:n,name:t})},delete_node:function(n){if(n=this._get_node(n),!n.length)return!1;this.__rollback();var t=this._get_parent(n),i=this._get_prev(n);return n=n.remove(),t!==-1&&t.find("> ul > li").length===0&&t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),this.clean_node(t),this.__callback({obj:n,prev:i}),n},prepare_move:function(t,r,u,f,e){var o={};if(o.ot=n.jstree._reference(o.o)||this,o.o=o.ot._get_node(t),o.r=r===-1?-1:this._get_node(r),o.p=typeof o=="undefined"?"last":u,!e&&i.o&&i.o[0]===o.o[0]&&i.r[0]===o.r[0]&&i.p===o.p){this.__callback(i),f&&f.call(this,i);return}if(o.ot=n.jstree._reference(o.o)||this,o.rt=r===-1?o.ot:n.jstree._reference(o.r)||this,o.r===-1){o.cr=-1;switch(o.p){case"first":case"before":case"inside":o.cp=0;break;case"after":case"last":o.cp=o.rt.get_container().find(" > ul > li").length;break;default:o.cp=o.p}}else{if(!/^(before|after)$/.test(o.p)&&!this._is_loaded(o.r))return this.load_node(o.r,function(){this.prepare_move(t,r,u,f,!0)});switch(o.p){case"before":o.cp=o.r.index(),o.cr=o.rt._get_parent(o.r);break;case"after":o.cp=o.r.index()+1,o.cr=o.rt._get_parent(o.r);break;case"inside":case"first":o.cp=0,o.cr=o.r;break;case"last":o.cp=o.r.find(" > ul > li").length,o.cr=o.r;break;default:o.cp=o.p,o.cr=o.r}}o.np=o.cr==-1?o.rt.get_container():o.cr,o.op=o.ot._get_parent(o.o),o.or=o.np.find(" > ul > li:nth-child("+(o.cp+1)+")"),i=o,this.__callback(i),f&&f.call(this,i)},check_move:function(){var n=i,t=!0;return n.or[0]===n.o[0]?!1:(n.o.each(function(){if(n.r.parentsUntil(".jstree").andSelf().filter("li").index(this)!==-1)return t=!1,!1}),t)},move_node:function(t,r,u,f,e,o){if(!e)return this.prepare_move(t,r,u,function(n){this.move_node(n,!1,!1,f,!0,o)});if(!o&&!this.check_move())return!1;this.__rollback();var s=!1;f?(s=t.o.clone(),s.find("*[id]").andSelf().each(function(){this.id&&(this.id="copy_"+this.id)})):s=t.o,t.or.length?t.or.before(s):(t.np.children("ul").length||n("<ul>").appendTo(t.np),t.np.children("ul:eq(0)").append(s));try{t.ot.clean_node(t.op),t.rt.clean_node(t.np),t.op.find("> ul > li").length||t.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(h){}return f&&(i.cy=!0,i.oc=s),this.__callback(i),i},_get_move:function(){return i}}})}(jQuery),function(n){n.jstree.plugin("ui",{__init:function(){this.data.ui.selected=n(),this.data.ui.last_selected=!1,this.data.ui.hovered=null,this.data.ui.to_select=this.get_settings().ui.initially_select,this.get_container().delegate("a","click.jstree",n.proxy(function(n){n.preventDefault(),this.select_node(n.currentTarget,!0,n)},this)).delegate("a","mouseenter.jstree",n.proxy(function(n){this.hover_node(n.target,n)},this)).delegate("a","mouseleave.jstree",n.proxy(function(n){this.dehover_node(n.target,n)},this)).bind("reopen.jstree",n.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",n.proxy(function(){this.dehover_node(),this.save_selected()},this)).bind("set_rollback.jstree",n.proxy(function(){this.reselect()},this)).bind("close_node.jstree",n.proxy(function(t,i){var u=this._get_settings().ui,r=this._get_node(i.rslt.obj),f=r&&r.length?r.children("ul").find(".jstree-clicked"):n(),e=this;u.selected_parent_close!==!1&&f.length&&f.each(function(){e.deselect_node(this),u.selected_parent_close==="select_parent"&&e.select_node(r)})},this)).bind("delete_node.jstree",n.proxy(function(n,t){var u=this._get_settings().ui.select_prev_on_delete,i=this._get_node(t.rslt.obj),r=i&&i.length?i.find(".jstree-clicked"):[],f=this;r.each(function(){f.deselect_node(this)}),u&&r.length&&this.select_node(t.rslt.prev)},this)).bind("move_node.jstree",n.proxy(function(n,t){t.rslt.cy&&t.rslt.oc.find(".jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",selected_parent_close:"select_parent",select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(t,i){if(typeof t=="undefined"||t===null)return i?this.data.ui.selected:this.data.ui.last_selected;var r=n(t,this.get_container());return r.is(".jstree")||t==-1?-1:(r=r.closest("li",this.get_container()),r.length?r:!1)},save_selected:function(){var n=this;this.data.ui.to_select=[],this.data.ui.selected.each(function(){n.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/"))}),this.__callback(this.data.ui.to_select)},reselect:function(){var i=this,t=this.data.ui.to_select;t=n.map(n.makeArray(t),function(n){return"#"+n.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")}),this.deselect_all(),n.each(t,function(n,t){t&&t!=="#"&&i.select_node(t)}),this.__callback()},refresh:function(){return this.save_selected(),this.__call_old()},hover_node:function(n){if(n=this._get_node(n),!n.length)return!1;n.hasClass("jstree-hovered")||this.dehover_node(),this.data.ui.hovered=n.children("a").addClass("jstree-hovered").parent(),this.__callback({obj:n})},dehover_node:function(){var n=this.data.ui.hovered,t;if(!n||!n.length)return!1;t=n.children("a").removeClass("jstree-hovered").parent(),this.data.ui.hovered[0]===t[0]&&(this.data.ui.hovered=null),this.__callback({obj:n})},select_node:function(n,t,i){if(n=this._get_node(n),n==-1||!n||!n.length)return!1;var r=this._get_settings().ui,f=r.select_multiple_modifier=="on"||r.select_multiple_modifier!==!1&&i&&i[r.select_multiple_modifier+"Key"],u=this.is_selected(n),e=!0,o=this;if(t){if(r.disable_selecting_children&&f&&n.parents("li",this.get_container()).children(".jstree-clicked").length)return!1;e=!1;switch(!0){case u&&!f:this.deselect_all(),u=!1,e=!0;break;case!u&&!f:(r.select_limit==-1||r.select_limit>0)&&(this.deselect_all(),e=!0);break;case u&&f:this.deselect_node(n);break;case!u&&f:(r.select_limit==-1||this.data.ui.selected.length+1<=r.select_limit)&&(e=!0)}}e&&!u&&(n.children("a").addClass("jstree-clicked"),r.selected_parent_open&&n.parents(".jstree-closed").each(function(){o.open_node(this,!1,!0)}),this.data.ui.selected=this.data.ui.selected.add(n),this.data.ui.last_selected=n,this.__callback({obj:n}))},deselect_node:function(n){if(n=this._get_node(n),!n.length)return!1;this.is_selected(n)&&(n.children("a").removeClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.not(n),this.data.ui.last_selected.get(0)===n.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:n}))},toggle_select:function(n){if(n=this._get_node(n),!n.length)return!1;this.is_selected(n)?this.deselect_node(n):this.select_node(n)},is_selected:function(n){return this.data.ui.selected.index(this._get_node(n))>=0},get_selected:function(t){return t?n(t).find(".jstree-clicked").parent():this.data.ui.selected},deselect_all:function(t){t?n(t).find(".jstree-clicked").removeClass("jstree-clicked"):this.get_container().find(".jstree-clicked").removeClass("jstree-clicked"),this.data.ui.selected=n([]),this.data.ui.last_selected=!1,this.__callback()}}}),n.jstree.defaults.plugins.push("ui")}(jQuery),function(n){n.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",n.proxy(function(n,t){if(this._get_settings().crrm.move.open_onmove){var i=this;t.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){i.open_node(this,!1,!0)})}},this))},defaults:{input_width_limit:200,move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(){return!0}}},_fn:{_show_input:function(t,i){t=this._get_node(t);var f=this._get_settings().core.rtl,o=this._get_settings().crrm.input_width_limit,s=t.children("ins").width(),h=t.find("> a:visible > ins").width()*t.find("> a:visible > ins").length,u=this.get_text(t),e=n("<div>",{css:{position:"absolute",top:"-200px",left:f?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),r=t.css("position","relative").append(n("<input>",{value:u,css:{padding:"0",border:"1px solid silver",position:"absolute",left:f?"auto":s+h+4+"px",right:f?s+h+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:n.proxy(function(){var r=t.children("input"),n=r.val();n===""&&(n=u),r.remove(),this.set_text(t,u),this.rename_node(t,n),i.call(this,t,n,u),t.css("position","")},this),keyup:function(n){var t=n.keyCode||n.which;if(t==27){this.value=u,this.blur();return}if(t==13){this.blur();return}r.width(Math.min(e.text("pW"+this.value).width(),o))}})).children("input");this.set_text(t,""),e.css({fontFamily:r.css("fontFamily")||"",fontSize:r.css("fontSize")||"",fontWeight:r.css("fontWeight")||"",fontStyle:r.css("fontStyle")||"",fontStretch:r.css("fontStretch")||"",fontVariant:r.css("fontVariant")||"",letterSpacing:r.css("letterSpacing")||"",wordSpacing:r.css("wordSpacing")||""}),r.width(Math.min(e.text("pW"+r[0].value).width(),o))[0].select()},rename:function(n){n=this._get_node(n),this.__rollback();var t=this.__callback;this._show_input(n,function(n,i,r){t.call(this,{obj:n,new_name:i,old_name:r})})},create:function(t,i,r,u,f,e){var o=this;return t=this._get_node(t),t||(t=-1),this.__rollback(),this.create_node(t,i,r,function(t){var i=this._get_parent(t),r=n(t).index();u&&u.call(this,t),f?o.__callback({obj:t,name:this.get_text(t),parent:i,position:r}):this._show_input(t,function(n,t){o.__callback({obj:n,name:t,parent:i,position:r})})},e)},remove:function(n){n=this._get_node(n,!0),this.__rollback(),this.delete_node(n),this.__callback({obj:n})},check_move:function(){if(!this.__call_old())return!1;var n=this._get_settings().crrm.move;return n.check_move.call(this,this._get_move())?!0:!1},move_node:function(n,t,i,r,u,f){var e=this._get_settings().crrm.move;if(!u)return i||(i=e.default_position),i!=="inside"||e.default_position.match(/^(before|after)$/)||(i=e.default_position),this.__call_old(!0,n,t,i,r,!1,f);(e.always_copy===!0||e.always_copy==="multitree"&&n.rt.get_index()!==n.ot.get_index())&&(r=!0),this.__call_old(!0,n,t,i,r,!0,f)},cut:function(n){if(n=this._get_node(n),this.data.crrm.cp_nodes=!1,this.data.crrm.ct_nodes=!1,!n||!n.length)return!1;this.data.crrm.ct_nodes=n},copy:function(n){if(n=this._get_node(n),this.data.crrm.cp_nodes=!1,this.data.crrm.ct_nodes=!1,!n||!n.length)return!1;this.data.crrm.cp_nodes=n},paste:function(n){if((n=this._get_node(n),!n||!n.length)||!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return!1;this.data.crrm.ct_nodes&&this.move_node(this.data.crrm.ct_nodes,n),this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,n,!1,!0),this.data.crrm.cp_nodes=!1,this.data.crrm.ct_nodes=!1}}}),n.jstree.defaults.plugins.push("crrm")}(jQuery),function(n){var t=[];n.jstree._themes=!1,n.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",n.proxy(function(){var n=this._get_settings().themes;this.data.themes.dots=n.dots,this.data.themes.icons=n.icons,this.set_theme(n.theme,n.url)},this)).bind("loaded.jstree",n.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,icons:!0},_fn:{set_theme:function(i,r){if(!i)return!1;r||(r=n.jstree._themes+i+"/style.css"),n.inArray(r,t)==-1&&(n.vakata.css.add_sheet({url:r,rel:"jstree"}),t.push(r)),this.data.themes.theme!=i&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=i),this.get_container().addClass("jstree-"+i),this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons(),this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=!0,this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1,this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0,this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1,this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}}),n(function(){n.jstree._themes===!1&&n("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))return n.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1}),n.jstree._themes===!1&&(n.jstree._themes="themes/")}),n.jstree.defaults.plugins.push("themes")}(jQuery),function(n){function i(t,i){var r=n.jstree._focused(),u;if(r&&r.data&&r.data.hotkeys&&r.data.hotkeys.enabled&&(u=r._get_settings().hotkeys[t],u))return u.call(r,i)}var t=[];n.jstree.plugin("hotkeys",{__init:function(){if(typeof n.hotkeys=="undefined")throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";n.each(this._get_settings().hotkeys,function(r){n.inArray(r,t)==-1&&(n(document).bind("keydown",r,function(n){return i(r,n)}),t.push(r))}),this.enable_hotkeys()},defaults:{up:function(){var n=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(n)),!1},down:function(){var n=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(n)),!1},left:function(){var n=this.data.ui.hovered||this.data.ui.last_selected;return n&&(n.hasClass("jstree-open")?this.close_node(n):this.hover_node(this._get_prev(n))),!1},right:function(){var n=this.data.ui.hovered||this.data.ui.last_selected;return n&&n.length&&(n.hasClass("jstree-closed")?this.open_node(n):this.hover_node(this._get_next(n))),!1},space:function(){return this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click(),!1},"ctrl+space":function(n){return n.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(n),!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}})}(jQuery),function(n){n.jstree.plugin("json_data",{defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1},_fn:{load_node:function(n,t,i){var r=this;this.load_node_json(n,function(){r.__callback({obj:n}),t.call(this)},i)},_is_loaded:function(t){var r=this._get_settings().json_data,i;return(t=this._get_node(t),t&&t!==-1&&r.progressive_render&&!t.is(".jstree-open, .jstree-leaf")&&t.children("ul").children("li").length===0&&t.data("jstree-children"))?(i=this._parse_json(t.data("jstree-children")),i&&(t.append(i),n.removeData(t,"jstree-children")),this.clean_node(t),!0):t==-1||!t||!r.ajax||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").size()>0},load_node_json:function(t,i,r){var u=this.get_settings().json_data,f,e=function(){},o=function(){};if(t=this._get_node(t),t&&t!==-1){if(t.data("jstree-is-loading"))return;t.data("jstree-is-loading",!0)}switch(!0){case!u.data&&!u.ajax:throw"Neither data nor ajax settings supplied.";case!!u.data&&!u.ajax||!!u.data&&!!u.ajax&&(!t||t===-1):t&&t!=-1||(f=this._parse_json(u.data),f?(this.get_container().children("ul").empty().append(f.children()),this.clean_node()):u.correct_state&&this.get_container().children("ul").empty()),i&&i.call(this);break;case!u.data&&!!u.ajax||!!u.data&&!!u.ajax&&t&&t!==-1:e=function(n,i,f){var e=this.get_settings().json_data.ajax.error;e&&e.call(this,n,i,f),t!=-1&&t.length?(t.children(".jstree-loading").removeClass("jstree-loading"),t.data("jstree-is-loading",!1),i==="success"&&u.correct_state&&t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")):i==="success"&&u.correct_state&&this.get_container().children("ul").empty(),r&&r.call(this)},o=function(r,f,o){var s=this.get_settings().json_data.ajax.success;if(s&&(r=s.call(this,r,f,o)||r),r===""||!n.isArray(r)&&!n.isPlainObject(r))return e.call(this,o,f,"");r=this._parse_json(r),r?(t!==-1&&t?(t.append(r).children(".jstree-loading").removeClass("jstree-loading"),t.data("jstree-is-loading",!1)):this.get_container().children("ul").empty().append(r.children()),this.clean_node(t),i&&i.call(this)):t!==-1&&t?(t.children(".jstree-loading").removeClass("jstree-loading"),t.data("jstree-is-loading",!1),u.correct_state&&(t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),i&&i.call(this))):u.correct_state&&(this.get_container().children("ul").empty(),i&&i.call(this))},u.ajax.context=this,u.ajax.error=e,u.ajax.success=o,u.ajax.dataType||(u.ajax.dataType="json"),n.isFunction(u.ajax.url)&&(u.ajax.url=u.ajax.url.call(this,t)),n.isFunction(u.ajax.data)&&(u.ajax.data=u.ajax.data.call(this,t)),n.ajax(u.ajax)}},_parse_json:function(t,i){var r=!1,s=this._get_settings(),l=s.json_data,h=s.core.html_titles,u,f,c,e,o;if(!t)return r;if(n.isFunction(t)&&(t=t.call(this)),n.isArray(t)){if(r=n(),!t.length)return!1;for(f=0,c=t.length;f<c;f++)u=this._parse_json(t[f],!0),u.length&&(r=r.add(u))}else{if(typeof t=="string"&&(t={data:t}),!t.data&&t.data!=="")return r;r=n("<li>"),t.attr&&r.attr(t.attr),t.metadata&&r.data("jstree",t.metadata),t.state&&r.addClass("jstree-"+t.state),n.isArray(t.data)||(u=t.data,t.data=[],t.data.push(u)),n.each(t.data,function(i,f){u=n("<a>"),n.isFunction(f)&&(f=f.call(this,t)),typeof f=="string"?u.attr("href","#")[h?"html":"text"](f):(f.attr||(f.attr={}),f.attr.href||(f.attr.href="#"),u.attr(f.attr)[h?"html":"text"](f.title),f.language&&u.addClass(f.language)),u.prepend("<ins class='jstree-icon'>&#160;<\/ins>"),!f.icon&&t.icon&&(f.icon=t.icon),f.icon&&(f.icon.indexOf("/")===-1?u.children("ins").addClass(f.icon):u.children("ins").css("background","url('"+f.icon+"') center center no-repeat")),r.append(u)}),r.prepend("<ins class='jstree-icon'>&#160;<\/ins>"),t.children&&(l.progressive_render&&t.state!=="open"?r.addClass("jstree-closed").data("jstree-children",t.children):(n.isFunction(t.children)&&(t.children=t.children.call(this,t)),n.isArray(t.children)&&t.children.length&&(u=this._parse_json(t.children,!0),u.length&&(o=n("<ul>"),o.append(u),r.append(o)))))}return i||(e=n("<ul>"),e.append(r),r=e),r},get_json:function(t,i,r,u){var v=[],h=this._get_settings(),c=this,o,e,s,l,f,a;return t=this._get_node(t),t&&t!==-1||(t=this.get_container().find("> ul > li")),i=n.isArray(i)?i:["id","class"],!u&&this.data.types&&i.push(h.types.type_attr),r=n.isArray(r)?r:[],t.each(function(){s=n(this),o={data:[]},i.length&&(o.attr={}),n.each(i,function(n,t){e=s.attr(t),e&&e.length&&e.replace(/jstree[^ ]*|$/ig,"").length&&(o.attr[t]=e.replace(/jstree[^ ]*|$/ig,""))}),s.hasClass("jstree-open")&&(o.state="open"),s.hasClass("jstree-closed")&&(o.state="closed"),l=s.children("a"),l.each(function(){f=n(this),r.length||n.inArray("languages",h.plugins)!==-1||f.children("ins").get(0).style.backgroundImage.length||f.children("ins").get(0).className&&f.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length?(a=!1,n.inArray("languages",h.plugins)!==-1&&n.isArray(h.languages)&&h.languages.length&&n.each(h.languages,function(n,t){if(f.hasClass(t))return a=t,!1}),e={attr:{},title:c.get_text(f,a)},n.each(r,function(n,t){o.attr[t]=(f.attr(t)||"").replace(/jstree[^ ]*|$/ig,"")}),n.each(h.languages,function(n,t){if(f.hasClass(t))return e.language=t,!0}),f.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(e.icon=f.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"")),f.children("ins").get(0).style.backgroundImage.length&&(e.icon=f.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")",""))):e=c.get_text(f),l.length>1?o.data.push(e):o.data=e}),s=s.find("> ul > li"),s.length&&(o.children=c.get_json(s,i,r,!0)),v.push(o)}),v}}})}(jQuery),function(n){n.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(t){var r=this._get_settings().languages,i=!1,u=".jstree-"+this.get_index()+" a";if(!n.isArray(r)||r.length===0)return!1;if(n.inArray(t,r)==-1){if(!r[t])return!1;t=r[t]}return t==this.data.languages.current_language?!0:(i=n.vakata.css.get_css(u+"."+this.data.languages.current_language,!1,this.data.languages.language_css),i!==!1&&(i.style.display="none"),i=n.vakata.css.get_css(u+"."+t,!1,this.data.languages.language_css),i!==!1&&(i.style.display=""),this.data.languages.current_language=t,this.__callback(t),!0)},get_lang:function(){return this.data.languages.current_language},get_text:function(t,i){if(t=this._get_node(t)||this.data.ui.last_selected,!t.size())return!1;var r=this._get_settings().languages,u=this._get_settings().core.html_titles;return n.isArray(r)&&r.length?(i=i&&n.inArray(i,r)!=-1?i:this.data.languages.current_language,t=t.children("a."+i)):t=t.children("a:eq(0)"),u?(t=t.clone(),t.children("INS").remove(),t.html()):(t=t.contents().filter(function(){return this.nodeType==3})[0],t.nodeValue)},set_text:function(t,i,r){if(t=this._get_node(t)||this.data.ui.last_selected,!t.size())return!1;var u=this._get_settings().languages,e=this._get_settings().core.html_titles,f;return n.isArray(u)&&u.length?(r=r&&n.inArray(r,u)!=-1?r:this.data.languages.current_language,t=t.children("a."+r)):t=t.children("a:eq(0)"),e?(f=t.children("INS").clone(),t.html(i).prepend(f),this.__callback({obj:t,name:i,lang:r}),!0):(t=t.contents().filter(function(){return this.nodeType==3})[0],this.__callback({obj:t,name:i,lang:r}),t.nodeValue=i)},_load_css:function(){var t=this._get_settings().languages,r="/* languages css */",u=".jstree-"+this.get_index()+" a",i;if(n.isArray(t)&&t.length){for(this.data.languages.current_language=t[0],i=0;i<t.length;i++)r+=u+"."+t[i]+" {",t[i]!=this.data.languages.current_language&&(r+=" display:none; "),r+=" } ";this.data.languages.language_css=n.vakata.css.add_sheet({str:r})}},create_node:function(t,i,r,u){return this.__call_old(!0,t,i,r,function(t){var i=this._get_settings().languages,f=t.children("a"),r;if(n.isArray(i)&&i.length){for(r=0;r<i.length;r++)f.is("."+i[r])||t.append(f.eq(0).clone().removeClass(i.join(" ")).addClass(i[r]));f.not("."+i.join(", .")).remove()}u&&u.call(this,t)})}}})}(jQuery),function(n){n.jstree.plugin("cookies",{__init:function(){if(typeof n.cookie=="undefined")throw"jsTree cookie: jQuery cookie plugin not included.";var i=this._get_settings().cookies,t;!i.save_opened||(t=n.cookie(i.save_opened),t&&t.length&&(this.data.core.to_open=t.split(","))),!i.save_selected||(t=n.cookie(i.save_selected),t&&t.length&&this.data.ui&&(this.data.ui.to_select=t.split(",")));this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",n.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",n.proxy(function(n){this._get_settings().cookies.auto_save&&this.save_cookie((n.handleObj.namespace+n.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(t){if(!this.data.core.refreshing){var i=this._get_settings().cookies;if(!t){i.save_opened&&(this.save_opened(),n.cookie(i.save_opened,this.data.core.to_open.join(","),i.cookie_options)),i.save_selected&&this.data.ui&&(this.save_selected(),n.cookie(i.save_selected,this.data.ui.to_select.join(","),i.cookie_options));return}switch(t){case"open_node":case"close_node":!i.save_opened||(this.save_opened(),n.cookie(i.save_opened,this.data.core.to_open.join(","),i.cookie_options));break;case"select_node":case"deselect_node":!!i.save_selected&&this.data.ui&&(this.save_selected(),n.cookie(i.save_selected,this.data.ui.to_select.join(","),i.cookie_options))}}}}}),n.jstree.defaults.plugins.push("cookies")}(jQuery),function(n){n.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",n.proxy(function(n,t){var i=this._get_node(t.rslt.obj);i=i===-1?this.get_container().children("ul"):i.children("ul"),this.sort(i)},this)).bind("rename_node.jstree",n.proxy(function(n,t){this.sort(t.rslt.obj.parent())},this)).bind("move_node.jstree",n.proxy(function(n,t){var i=t.rslt.np==-1?this.get_container():t.rslt.np;this.sort(i.children("ul"))},this))},defaults:function(n,t){return this.get_text(n)>this.get_text(t)?1:-1},_fn:{sort:function(t){var r=this._get_settings().sort,i=this;t.append(n.makeArray(t.children("li")).sort(n.proxy(r,i))),t.find("> li > ul").each(function(){i.sort(n(this))}),this.clean_node(t)}}})}(jQuery),function(n){var i=!1,t=!1,f=!1,r=!1,u=!1,e=!1,o=!1;n.vakata.dnd={is_down:!1,is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,user_data:{},drag_start:function(t,i,r){n.vakata.dnd.is_drag&&n.vakata.drag_stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.MozUserSelect="none")}catch(u){}return n.vakata.dnd.init_x=t.pageX,n.vakata.dnd.init_y=t.pageY,n.vakata.dnd.user_data=i,n.vakata.dnd.is_down=!0,n.vakata.dnd.helper=n("<div id='vakata-dragged'>").html(r).css("opacity","0.75"),n(document).bind("mousemove",n.vakata.dnd.drag),n(document).bind("mouseup",n.vakata.dnd.drag_stop),!1},drag:function(t){if(n.vakata.dnd.is_down){if(!n.vakata.dnd.is_drag)if(Math.abs(t.pageX-n.vakata.dnd.init_x)>5||Math.abs(t.pageY-n.vakata.dnd.init_y)>5)n.vakata.dnd.helper.appendTo("body"),n.vakata.dnd.is_drag=!0,n(document).triggerHandler("drag_start.vakata",{event:t,data:n.vakata.dnd.user_data});else return;if(t.type==="mousemove"){var i=n(document),f=i.scrollTop(),s=i.scrollLeft();t.pageY-f<20?(u&&e==="down"&&(clearInterval(u),u=!1),u||(e="up",u=setInterval(function(){n(document).scrollTop(n(document).scrollTop()-n.vakata.dnd.scroll_spd)},150))):u&&e==="up"&&(clearInterval(u),u=!1),n(window).height()-(t.pageY-f)<20?(u&&e==="up"&&(clearInterval(u),u=!1),u||(e="down",u=setInterval(function(){n(document).scrollTop(n(document).scrollTop()+n.vakata.dnd.scroll_spd)},150))):u&&e==="down"&&(clearInterval(u),u=!1),t.pageX-s<20?(r&&o==="right"&&(clearInterval(r),r=!1),r||(o="left",r=setInterval(function(){n(document).scrollLeft(n(document).scrollLeft()-n.vakata.dnd.scroll_spd)},150))):r&&o==="left"&&(clearInterval(r),r=!1),n(window).width()-(t.pageX-s)<20?(r&&o==="left"&&(clearInterval(r),r=!1),r||(o="right",r=setInterval(function(){n(document).scrollLeft(n(document).scrollLeft()+n.vakata.dnd.scroll_spd)},150))):r&&o==="right"&&(clearInterval(r),r=!1)}n.vakata.dnd.helper.css({left:t.pageX+5+"px",top:t.pageY+10+"px"}),n(document).triggerHandler("drag.vakata",{event:t,data:n.vakata.dnd.user_data})}},drag_stop:function(t){n(document).unbind("mousemove",n.vakata.dnd.drag),n(document).unbind("mouseup",n.vakata.dnd.drag_stop),n(document).triggerHandler("drag_stop.vakata",{event:t,data:n.vakata.dnd.user_data}),n.vakata.dnd.helper.remove(),n.vakata.dnd.init_x=0,n.vakata.dnd.init_y=0,n.vakata.dnd.user_data={},n.vakata.dnd.is_down=!1,n.vakata.dnd.is_drag=!1}},n(function(){n.vakata.css.add_sheet({str:"#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } "})}),n.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1},this.get_container().bind("mouseenter.jstree",n.proxy(function(){n.vakata.dnd.is_drag&&n.vakata.dnd.user_data.jstree&&this.data.themes&&(f.attr("class","jstree-"+this.data.themes.theme),n.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme))},this)).bind("mouseleave.jstree",n.proxy(function(){n.vakata.dnd.is_drag&&n.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2))},this)).bind("mousemove.jstree",n.proxy(function(t){if(n.vakata.dnd.is_drag&&n.vakata.dnd.user_data.jstree){var i=this.get_container()[0];t.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(n.proxy(function(){this.scrollLeft+=n.vakata.dnd.scroll_spd},i),100)):t.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(n.proxy(function(){this.scrollLeft-=n.vakata.dnd.scroll_spd},i),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1),t.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(n.proxy(function(){this.scrollTop+=n.vakata.dnd.scroll_spd},i),100)):t.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(n.proxy(function(){this.scrollTop-=n.vakata.dnd.scroll_spd},i),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).delegate("a","mousedown.jstree",n.proxy(function(n){if(n.which===1)return this.start_drag(n.currentTarget,n),!1},this)).delegate("a","mouseenter.jstree",n.proxy(function(t){n.vakata.dnd.is_drag&&n.vakata.dnd.user_data.jstree&&this.dnd_enter(t.currentTarget)},this)).delegate("a","mousemove.jstree",n.proxy(function(t){n.vakata.dnd.is_drag&&n.vakata.dnd.user_data.jstree&&(typeof this.data.dnd.off.top=="undefined"&&(this.data.dnd.off=n(t.target).offset()),this.data.dnd.w=(t.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,this.data.dnd.w<0&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",n.proxy(function(i){n.vakata.dnd.is_drag&&n.vakata.dnd.user_data.jstree&&(this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,n.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),f.hide(),t&&t[0]===i.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2&&(clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1)))},this)).delegate("a","mouseup.jstree",n.proxy(function(t){n.vakata.dnd.is_drag&&n.vakata.dnd.user_data.jstree&&this.dnd_finish(t)},this)),n(document).bind("drag_stop.vakata",n.proxy(function(){this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,this.data.dnd.off=!1,this.data.dnd.prepared=!1,this.data.dnd.w=!1,this.data.dnd.to1=!1,this.data.dnd.to2=!1,this.data.dnd.active=!1,this.data.dnd.foreign=!1,f&&f.css({top:"-2000px"})},this)).bind("drag_start.vakata",n.proxy(function(t,i){if(i.data.jstree){var r=n(i.event.target);r.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(r)}},this));var r=this._get_settings().dnd;r.drag_target&&n(document).delegate(r.drag_target,"mousedown.jstree",n.proxy(function(t){i=t.target,n.vakata.dnd.drag_start(t,{jstree:!0,obj:t.target},"<ins class='jstree-icon'><\/ins>"+n(t.target).text()),this.data.themes&&(f.attr("class","jstree-"+this.data.themes.theme),n.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),n.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var r=this.get_container();return this.data.dnd.cof=r.offset(),this.data.dnd.cw=parseInt(r.width(),10),this.data.dnd.ch=parseInt(r.height(),10),this.data.dnd.foreign=!0,!1},this)),r.drop_target&&n(document).delegate(r.drop_target,"mouseenter.jstree",n.proxy(function(t){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:i,r:n(t.target)})&&n.vakata.dnd.helper.children("ins").attr("class","jstree-ok")},this)).delegate(r.drop_target,"mouseleave.jstree",n.proxy(function(){this.data.dnd.active&&n.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(r.drop_target,"mouseup.jstree",n.proxy(function(t){this.data.dnd.active&&n.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:i,r:n(t.target)})},this))},defaults:{copy_modifier:"ctrl",check_timeout:200,open_timeout:500,drop_target:".jstree-drop",drop_check:function(){return!0},drop_finish:n.noop,drag_target:".jstree-draggable",drag_finish:n.noop,drag_check:function(){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(t&&t.length){if(this.data.dnd.off=t.offset(),this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+t.width()),this.data.dnd.foreign){var n=this._get_settings().dnd.drag_check.call(this,{o:i,r:t});return this.data.dnd.after=n.after,this.data.dnd.before=n.before,this.data.dnd.inside=n.inside,this.data.dnd.prepared=!0,this.dnd_show()}return this.prepare_move(i,t,"before"),this.data.dnd.before=this.check_move(),this.prepare_move(i,t,"after"),this.data.dnd.after=this.check_move(),this._is_loaded(t)?(this.prepare_move(i,t,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1,this.data.dnd.prepared=!0,this.dnd_show()}},dnd_show:function(){if(this.data.dnd.prepared){var r=["before","inside","after"],t=!1,u=this._get_settings().core.rtl,i;r=this.data.dnd.w<this.data.core.li_height/3?["before","inside","after"]:this.data.dnd.w<=this.data.core.li_height*2/3?this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:["after","inside","before"],n.each(r,n.proxy(function(i,r){if(this.data.dnd[r])return n.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),t=r,!1},this)),t===!1&&n.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),i=u?this.data.dnd.off.right-18:this.data.dnd.off.left+10;switch(t){case"before":f.css({left:i+"px",top:this.data.dnd.off.top-6+"px"}).show();break;case"after":f.css({left:i+"px",top:this.data.dnd.off.top+this.data.core.li_height-7+"px"}).show();break;case"inside":f.css({left:i+(u?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show();break;default:f.hide()}return t}},dnd_open:function(){this.data.dnd.to2=!1,this.open_node(t,n.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(n){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:i,r:t}):(this.dnd_prepare(),this.move_node(i,t,this.dnd_show(),n[this._get_settings().dnd.copy_modifier+"Key"])),i=!1,t=!1,f.hide()},dnd_enter:function(i){var r=this._get_settings().dnd;this.data.dnd.prepared=!1,t=this._get_node(i),r.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(n.proxy(this.dnd_prepare,this),r.check_timeout)):this.dnd_prepare(),r.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),t&&t.length&&t.hasClass("jstree-closed")&&(this.data.dnd.to2=setTimeout(n.proxy(this.dnd_open,this),r.open_timeout))):t&&t.length&&t.hasClass("jstree-closed")&&this.dnd_open()},start_drag:function(t,r){i=this._get_node(t),this.data.ui&&this.is_selected(i)&&(i=this._get_node(null,!0)),n.vakata.dnd.drag_start(r,{jstree:!0,obj:i},"<ins class='jstree-icon'><\/ins>"+(i.length>1?"Multiple selection":this.get_text(i))),this.data.themes&&(f.attr("class","jstree-"+this.data.themes.theme),n.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));var u=this.get_container();this.data.dnd.cof=u.children("ul").offset(),this.data.dnd.cw=parseInt(u.width(),10),this.data.dnd.ch=parseInt(u.height(),10),this.data.dnd.active=!0}}}),n(function(){n.vakata.css.add_sheet({str:"#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; line-height:12px; font-size:1px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:silver; } "}),f=n("<div>").attr({id:"jstree-marker"}).hide().appendTo("body"),n(document).bind("drag_start.vakata",function(n,t){t.data.jstree&&f.show()}),n(document).bind("drag_stop.vakata",function(n,t){t.data.jstree&&f.hide()})})}(jQuery),function(n){n.jstree.plugin("checkbox",{__init:function(){this.select_node=this.deselect_node=this.deselect_all=n.noop,this.get_selected=this.get_checked,this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree",n.proxy(function(n,t){this._prepare_checkboxes(t.rslt.obj)},this)).bind("loaded.jstree",n.proxy(function(){this._prepare_checkboxes()},this)).delegate("a","click.jstree",n.proxy(function(n){this._get_node(n.target).hasClass("jstree-checked")?this.uncheck_node(n.target):this.check_node(n.target),this.data.ui&&this.save_selected(),this.data.cookies&&this.save_cookie("select_node"),n.preventDefault()},this))},__destroy:function(){this.get_container().find(".jstree-checkbox").remove()},_fn:{_prepare_checkboxes:function(t){t=!t||t==-1?this.get_container():this._get_node(t);var r,u=this,i;t.each(function(){i=n(this),r=i.is("li")&&i.hasClass("jstree-checked")?"jstree-checked":"jstree-unchecked",i.find("a").not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;<\/ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(r)}),t.is("li")?this._repair_state(t):t.find("> ul > li").each(function(){u._repair_state(this)})},change_state:function(t,i){t=this._get_node(t),i=i===!1||i===!0?i:t.hasClass("jstree-checked"),i?t.find("li").andSelf().removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"):(t.find("li").andSelf().removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),this.data.ui&&(this.data.ui.last_selected=t),this.data.checkbox.last_selected=t),t.parentsUntil(".jstree","li").each(function(){var t=n(this);if(i){if(t.children("ul").children(".jstree-checked, .jstree-undetermined").length)return t.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),!1;t.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked")}else{if(t.children("ul").children(".jstree-unchecked, .jstree-undetermined").length)return t.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),!1;t.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked")}}),this.data.ui&&(this.data.ui.selected=this.get_checked()),this.__callback(t)},check_node:function(n){this.change_state(n,!1)},uncheck_node:function(n){this.change_state(n,!0)},check_all:function(){var n=this;this.get_container().children("ul").children("li").each(function(){n.check_node(this,!1)})},uncheck_all:function(){var n=this;this.get_container().children("ul").children("li").each(function(){n.change_state(this,!0)})},is_checked:function(n){return n=this._get_node(n),n.length?n.is(".jstree-checked"):!1},get_checked:function(n){return n=!n||n===-1?this.get_container():this._get_node(n),n.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(n){return n=!n||n===-1?this.get_container():this._get_node(n),n.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(n){if(n=this._get_node(n),n.length){var t=n.find("> ul > .jstree-checked").length,r=n.find("> ul > .jstree-undetermined").length,i=n.find("> ul > li").length;i===0?n.hasClass("jstree-undetermined")&&this.check_node(n):t===0&&r===0?this.uncheck_node(n):t===i?this.check_node(n):n.parentsUntil(".jstree","li").removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined")}},reselect:function(){if(this.data.ui){var i=this,t=this.data.ui.to_select;t=n.map(n.makeArray(t),function(n){return"#"+n.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")}),this.deselect_all(),n.each(t,function(n,t){i.check_node(t)}),this.__callback()}}}})}(jQuery),function(n){n.vakata.xslt=function(t,i,r){var f="",e,o,u,s;return document.recalc?(e=document.createElement("xml"),o=document.createElement("xml"),e.innerHTML=t,o.innerHTML=i,n("body").append(e).append(o),setTimeout(function(n,t,i){return function(){i.call(null,n.transformNode(t.XMLDocument)),setTimeout(function(n,t){return function(){jQuery("body").remove(n).remove(t)}}(n,t),200)}}(e,o,r),100),!0):typeof window.DOMParser!="undefined"&&typeof window.XMLHttpRequest!="undefined"&&typeof window.XSLTProcessor!="undefined"?(u=new XSLTProcessor,s=n.isFunction(u.transformDocument)?typeof window.XMLSerializer!="undefined":!0,!s)?!1:(t=(new DOMParser).parseFromString(t,"text/xml"),i=(new DOMParser).parseFromString(i,"text/xml"),n.isFunction(u.transformDocument)?(f=document.implementation.createDocument("","",null),u.transformDocument(t,i,f,null),r.call(null,XMLSerializer().serializeToString(f)),!0):(u.importStylesheet(i),f=u.transformToFragment(t,document),r.call(null,n("<div>").append(f).html()),!0)):!1};var t={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">\t<xsl:call-template name="nodes">\t\t<xsl:with-param name="node" select="/root" />\t<\/xsl:call-template><\/xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<ul>\t<xsl:for-each select="$node/item">\t\t<xsl:variable name="children" select="count(./item) &gt; 0" />\t\t<li>\t\t\t<xsl:attribute name="class">\t\t\t\t<xsl:if test="position() = last()">jstree-last <\/xsl:if>\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@state = \'open\'">jstree-open <\/xsl:when>\t\t\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed <\/xsl:when>\t\t\t\t\t<xsl:otherwise>jstree-leaf <\/xsl:otherwise>\t\t\t\t<\/xsl:choose>\t\t\t\t<xsl:value-of select="@class" />\t\t\t<\/xsl:attribute>\t\t\t<xsl:for-each select="@*">\t\t\t\t<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /><\/xsl:attribute>\t\t\t\t<\/xsl:if>\t\t\t<\/xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;<\/xsl:text><\/ins>\t\t\t<xsl:for-each select="content/name">\t\t\t\t<a>\t\t\t\t<xsl:attribute name="href">\t\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /><\/xsl:when>\t\t\t\t\t<xsl:otherwise>#<\/xsl:otherwise>\t\t\t\t\t<\/xsl:choose>\t\t\t\t<\/xsl:attribute>\t\t\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /><\/xsl:attribute>\t\t\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /><\/xsl:attribute>\t\t\t\t<xsl:for-each select="@*">\t\t\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /><\/xsl:attribute>\t\t\t\t\t<\/xsl:if>\t\t\t\t<\/xsl:for-each>\t\t\t\t\t<ins>\t\t\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /><\/xsl:if>\t\t\t\t\t\t<\/xsl:attribute>\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;<\/xsl:attribute><\/xsl:if>\t\t\t\t\t\t<xsl:text>&#xa0;<\/xsl:text>\t\t\t\t\t<\/ins>\t\t\t\t\t<xsl:value-of select="current()" />\t\t\t\t<\/a>\t\t\t<\/xsl:for-each>\t\t\t<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /><\/xsl:call-template><\/xsl:if>\t\t<\/li>\t<\/xsl:for-each>\t<\/ul><\/xsl:template><\/xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">\t<ul>\t<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">\t\t<xsl:call-template name="nodes">\t\t\t<xsl:with-param name="node" select="." />\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t<\/xsl:call-template>\t<\/xsl:for-each>\t<\/ul><\/xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<xsl:param name="is_last" />\t<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />\t<li>\t<xsl:attribute name="class">\t\t<xsl:if test="$is_last = true()">jstree-last <\/xsl:if>\t\t<xsl:choose>\t\t\t<xsl:when test="@state = \'open\'">jstree-open <\/xsl:when>\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed <\/xsl:when>\t\t\t<xsl:otherwise>jstree-leaf <\/xsl:otherwise>\t\t<\/xsl:choose>\t\t<xsl:value-of select="@class" />\t<\/xsl:attribute>\t<xsl:for-each select="@*">\t\t<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /><\/xsl:attribute>\t\t<\/xsl:if>\t<\/xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;<\/xsl:text><\/ins>\t<xsl:for-each select="content/name">\t\t<a>\t\t<xsl:attribute name="href">\t\t\t<xsl:choose>\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /><\/xsl:when>\t\t\t<xsl:otherwise>#<\/xsl:otherwise>\t\t\t<\/xsl:choose>\t\t<\/xsl:attribute>\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /><\/xsl:attribute>\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /><\/xsl:attribute>\t\t<xsl:for-each select="@*">\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /><\/xsl:attribute>\t\t\t<\/xsl:if>\t\t<\/xsl:for-each>\t\t\t<ins>\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /><\/xsl:if>\t\t\t\t<\/xsl:attribute>\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;<\/xsl:attribute><\/xsl:if>\t\t\t\t<xsl:text>&#xa0;<\/xsl:text>\t\t\t<\/ins>\t\t\t<xsl:value-of select="current()" />\t\t<\/a>\t<\/xsl:for-each>\t<xsl:if test="$children">\t\t<ul>\t\t<xsl:for-each select="//item[@parent_id=$node/attribute::id]">\t\t\t<xsl:call-template name="nodes">\t\t\t\t<xsl:with-param name="node" select="." />\t\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t\t<\/xsl:call-template>\t\t<\/xsl:for-each>\t\t<\/ul>\t<\/xsl:if>\t<\/li><\/xsl:template><\/xsl:stylesheet>'};n.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0},_fn:{load_node:function(n,t,i){var r=this;this.load_node_xml(n,function(){r.__callback({obj:n}),t.call(this)},i)},_is_loaded:function(n){var t=this._get_settings().xml_data;return n=this._get_node(n),n==-1||!n||!t.ajax||n.is(".jstree-open, .jstree-leaf")||n.children("ul").children("li").size()>0},load_node_xml:function(t,i,r){var u=this.get_settings().xml_data,f=function(){},e=function(){};if(t=this._get_node(t),t&&t!==-1){if(t.data("jstree-is-loading"))return;t.data("jstree-is-loading",!0)}switch(!0){case!u.data&&!u.ajax:throw"Neither data nor ajax settings supplied.";case!!u.data&&!u.ajax||!!u.data&&!!u.ajax&&(!t||t===-1):t&&t!=-1||this.parse_xml(u.data,n.proxy(function(r){r?(r=r.replace(/ ?xmlns="[^"]*"/ig,""),r.length>10&&(r=n(r),this.get_container().children("ul").empty().append(r.children()),u.clean_node&&this.clean_node(t),i&&i.call(this))):u.correct_state&&(this.get_container().children("ul").empty(),i&&i.call(this))},this));break;case!u.data&&!!u.ajax||!!u.data&&!!u.ajax&&t&&t!==-1:f=function(n,i,f){var e=this.get_settings().xml_data.ajax.error;e&&e.call(this,n,i,f),t!==-1&&t.length?(t.children(".jstree-loading").removeClass("jstree-loading"),t.data("jstree-is-loading",!1),i==="success"&&u.correct_state&&t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")):i==="success"&&u.correct_state&&this.get_container().children("ul").empty(),r&&r.call(this)},e=function(r,e,o){r=o.responseText;var s=this.get_settings().xml_data.ajax.success;if(s&&(r=s.call(this,r,e,o)||r),r=="")return f.call(this,o,e,"");this.parse_xml(r,n.proxy(function(r){r&&(r=r.replace(/ ?xmlns="[^"]*"/ig,""),r.length>10?(r=n(r),t!==-1&&t?(t.children(".jstree-loading").removeClass("jstree-loading"),t.append(r),t.data("jstree-is-loading",!1)):this.get_container().children("ul").empty().append(r.children()),u.clean_node&&this.clean_node(t),i&&i.call(this)):t&&t!==-1?(t.children(".jstree-loading").removeClass("jstree-loading"),t.data("jstree-is-loading",!1),u.correct_state&&(t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),i&&i.call(this))):u.correct_state&&(this.get_container().children("ul").empty(),i&&i.call(this)))},this))},u.ajax.context=this,u.ajax.error=f,u.ajax.success=e,u.ajax.dataType||(u.ajax.dataType="xml"),n.isFunction(u.ajax.url)&&(u.ajax.url=u.ajax.url.call(this,t)),n.isFunction(u.ajax.data)&&(u.ajax.data=u.ajax.data.call(this,t)),n.ajax(u.ajax)}},parse_xml:function(i,r){var u=this._get_settings().xml_data;n.vakata.xslt(i,t[u.xsl],r)},get_xml:function(t,i,r,u,f){var e="",c=this._get_settings(),a=this,s,h,o,v,l;return t||(t="flat"),f||(f=0),i=this._get_node(i),i&&i!==-1||(i=this.get_container().find("> ul > li")),r=n.isArray(r)?r:["id","class"],!f&&this.data.types&&n.inArray(c.types.type_attr,r)===-1&&r.push(c.types.type_attr),u=n.isArray(u)?u:[],f||(e+="<root>"),i.each(function(){e+="<item",o=n(this),n.each(r,function(n,t){e+=" "+t+'="'+(o.attr(t)||"").replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"")+'"'}),o.hasClass("jstree-open")&&(e+=' state="open"'),o.hasClass("jstree-closed")&&(e+=' state="closed"'),t==="flat"&&(e+=' parent_id="'+f+'"'),e+=">",e+="<content>",v=o.children("a"),v.each(function(){s=n(this),l=!1,e+="<name",n.inArray("languages",c.plugins)!==-1&&n.each(c.languages,function(n,t){if(s.hasClass(t))return e+=' lang="'+t+'"',l=t,!1}),u.length&&n.each(u,function(n,t){e+=" "+t+'="'+(s.attr(t)||"").replace(/jstree[^ ]*|$/ig,"")+'"'}),s.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(e+=' icon="'+s.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"")+'"'),s.children("ins").get(0).style.backgroundImage.length&&(e+=' icon="'+s.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")+'"'),e+=">",e+="<![CDATA["+a.get_text(s,l)+"]\]>",e+="<\/name>"}),e+="<\/content>",h=o[0].id,o=o.find("> ul > li"),h=o.length?a.get_xml(t,o,r,u,h):"",t=="nest"&&(e+=h),e+="<\/item>",t=="flat"&&(e+=h)}),f||(e+="<\/root>"),e}}})}(jQuery),function(n){n.expr[":"].jstree_contains=function(n,t,i){return(n.textContent||n.innerText||"").toLowerCase().indexOf(i[3].toLowerCase())>=0},n.jstree.plugin("search",{__init:function(){this.data.search.str="",this.data.search.result=n()},defaults:{ajax:!1,case_insensitive:!1},_fn:{search:function(t,i){if(t!==""){var r=this.get_settings().search,e=this,u=function(){},f=function(){};if(this.data.search.str=t,!i&&r.ajax!==!1&&this.get_container().find(".jstree-closed:eq(0)").length>0){this.search.supress_callback=!0,u=function(){},f=function(n,t,i){var r=this.get_settings().search.ajax.success;r&&(n=r.call(this,n,t,i)||n),this.data.search.to_open=n,this._search_open()},r.ajax.context=this,r.ajax.error=u,r.ajax.success=f,n.isFunction(r.ajax.url)&&(r.ajax.url=r.ajax.url.call(this,t)),n.isFunction(r.ajax.data)&&(r.ajax.data=r.ajax.data.call(this,t)),r.ajax.data||(r.ajax.data={search_string:t}),(!r.ajax.dataType||/^json/.exec(r.ajax.dataType))&&(r.ajax.dataType="json"),n.ajax(r.ajax);return}this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+(r.case_insensitive?"jstree_contains":"contains")+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parents(".jstree-closed").each(function(){e.open_node(this,!1,!0)}),this.__callback({nodes:this.data.search.result,str:t})}},clear_search:function(){this.data.search.result.removeClass("jstree-search"),this.__callback(this.data.search.result),this.data.search.result=n()},_search_open:function(){var i=this,r=!0,t=[],u=[];this.data.search.to_open.length&&(n.each(this.data.search.to_open,function(i,r){if(r=="#")return!0;n(r).length&&n(r).is(".jstree-closed")?t.push(r):u.push(r)}),t.length&&(this.data.search.to_open=u,n.each(t,function(n,t){i.open_node(t,function(){i._search_open(!0)})}),r=!1)),r&&this.search(this.data.search.str,!0)}}})}(jQuery),function(n){n.vakata.context={cnt:n("<div id='vakata-contextmenu'>"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,show:function(t,i,r,u,f,e){var h=n.vakata.context.parse(t),o,s;h&&(n.vakata.context.vis=!0,n.vakata.context.tgt=i,n.vakata.context.par=e||i||null,n.vakata.context.data=f||null,n.vakata.context.cnt.html(h).css({visibility:"hidden",display:"block",left:0,top:0}),o=n.vakata.context.cnt.height(),s=n.vakata.context.cnt.width(),r+s>n(document).width()&&(r=n(document).width()-(s+5),n.vakata.context.cnt.find("li > ul").addClass("right")),u+o>n(document).height()&&(u=u-(o+i[0].offsetHeight),n.vakata.context.cnt.find("li > ul").addClass("bottom")),n.vakata.context.cnt.css({left:r,top:u}).find("li:has(ul)").bind("mouseenter",function(){var i=n(document).width(),r=n(document).height(),t=n(this).children("ul").show();i!==n(document).width()&&t.toggleClass("right"),r!==n(document).height()&&t.toggleClass("bottom")}).bind("mouseleave",function(){n(this).children("ul").hide()}).end().css({visibility:"visible"}).show(),n(document).triggerHandler("context_show.vakata"))},hide:function(){n.vakata.context.vis=!1,n.vakata.context.cnt.attr("class","").hide(),n(document).triggerHandler("context_hide.vakata")},parse:function(t,i){if(!t)return!1;var r="",u=!1,f=!0;return i||(n.vakata.context.func={}),r+="<ul>",n.each(t,function(t,i){if(!i)return!0;n.vakata.context.func[t]=i.action,!f&&i.separator_before&&(r+="<li class='vakata-separator vakata-separator-before'><\/li>"),f=!1,r+="<li class='"+(i._class||"")+(i._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ",i.icon&&i.icon.indexOf("/")===-1&&(r+=" class='"+i.icon+"' "),i.icon&&i.icon.indexOf("/")!==-1&&(r+=" style='background:url("+i.icon+") center center no-repeat;' "),r+=">&#160;<\/ins><a href='#' rel='"+t+"'>",i.submenu&&(r+="<span style='float:right;'>&raquo;<\/span>"),r+=i.label+"<\/a>",i.submenu&&(u=n.vakata.context.parse(i.submenu,!0),u&&(r+=u)),r+="<\/li>",i.separator_after&&(r+="<li class='vakata-separator vakata-separator-after'><\/li>",f=!0)}),r=r.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,""),r+="<\/ul>",r.length>10?r:!1},exec:function(t){return n.isFunction(n.vakata.context.func[t])?(n.vakata.context.func[t].call(n.vakata.context.data,n.vakata.context.par),!0):!1}},n(function(){n.vakata.css.add_sheet({str:"#vakata-contextmenu { display:none; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } "}),n.vakata.context.cnt.delegate("a","click",function(n){n.preventDefault()}).delegate("a","mouseup",function(){!n(this).parent().hasClass("jstree-contextmenu-disabled")&&n.vakata.context.exec(n(this).attr("rel"))?n.vakata.context.hide():n(this).blur()}).delegate("a","mouseover",function(){n.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body"),n(document).bind("mousedown",function(t){n.vakata.context.vis&&!n.contains(n.vakata.context.cnt[0],t.target)&&n.vakata.context.hide()}),typeof n.hotkeys!="undefined"&&n(document).bind("keydown","up",function(t){if(n.vakata.context.vis){var i=n.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();i.length||(i=n.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()),i.addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault()}}).bind("keydown","down",function(t){if(n.vakata.context.vis){var i=n.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();i.length||(i=n.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()),i.addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault()}}).bind("keydown","right",function(t){n.vakata.context.vis&&(n.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault())}).bind("keydown","left",function(t){n.vakata.context.vis&&(n.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault())}).bind("keydown","esc",function(t){n.vakata.context.hide(),t.preventDefault()}).bind("keydown","space",function(t){n.vakata.context.cnt.find(".vakata-hover").last().children("a").click(),t.preventDefault()})}),n.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",n.proxy(function(n){n.preventDefault(),this.show_contextmenu(n.currentTarget,n.pageX,n.pageY)},this)).bind("destroy.jstree",n.proxy(function(){this.data.contextmenu&&n.vakata.context.hide()},this)),n(document).bind("context_hide.vakata",n.proxy(function(){this.data.contextmenu=!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(n){this.create(n)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(n){this.rename(n)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(n){this.remove(n)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(n){this.cut(n)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(n){this.copy(n)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(n){this.paste(n)}}}}}},_fn:{show_contextmenu:function(t,i,r){t=this._get_node(t);var u=this.get_settings().contextmenu,e=t.children("a:visible:eq(0)"),f=!1;u.select_node&&this.data.ui&&!this.is_selected(t)&&(this.deselect_all(),this.select_node(t,!0)),(u.show_at_node||typeof i=="undefined"||typeof r=="undefined")&&(f=e.offset(),i=f.left,r=f.top+this.data.core.li_height),n.isFunction(u.items)&&(u.items=u.items.call(this,t)),this.data.contextmenu=!0,n.vakata.context.show(u.items,e,i,r,this,t),this.data.themes&&n.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})}(jQuery),function(n){n.jstree.plugin("types",{__init:function(){var t=this._get_settings().types;this.data.types.attach_to=[],this.get_container().bind("init.jstree",n.proxy(function(){var u=t.types,f=t.type_attr,i="",r=this;n.each(u,function(t,u){if(n.each(u,function(n){/^(max_depth|max_children|icon|valid_children)$/.test(n)||r.data.types.attach_to.push(n)}),!u.icon)return!0;(u.icon.image||u.icon.position)&&(i+=t=="default"?".jstree-"+r.get_index()+" a > .jstree-icon { ":".jstree-"+r.get_index()+" li["+f+"="+t+"] > a > .jstree-icon { ",u.icon.image&&(i+=" background-image:url("+u.icon.image+"); "),i+=u.icon.position?" background-position:"+u.icon.position+"; ":" background-position:0 0; ",i+="} ")}),i!=""&&n.vakata.css.add_sheet({str:i})},this)).bind("before.jstree",n.proxy(function(t,i){if(n.inArray(i.func,this.data.types.attach_to)!==-1){var r=this._get_settings().types.types,u=this._get_type(i.args[0]);if((r[u]&&typeof r[u][i.func]!="undefined"||r["default"]&&typeof r["default"][i.func]!="undefined")&&!this._check(i.func,i.args[0]))return t.stopImmediatePropagation(),!1}},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_get_type:function(n){return n=this._get_node(n),!n||!n.length?!1:n.attr(this._get_settings().types.type_attr)||"default"},set_type:function(n,t){return t=this._get_node(t),!t.length||!n?!1:t.attr(this._get_settings().types.type_attr,n)},_check:function(t,i,r){var u=!1,o=this._get_type(i),e=0,s=this,f=this._get_settings().types;if(i===-1){if(!f[t])return;u=f[t]}else{if(o===!1)return;!f.types[o]||!f.types[o][t]?!f.types["default"]||!f.types["default"][t]||(u=f.types["default"][t]):u=f.types[o][t]}return n.isFunction(u)&&(u=u.call(this,i)),t==="max_depth"&&i!==-1&&r!==!1&&f.max_depth!==-2&&u!==0&&this._get_node(i).children("a:eq(0)").parentsUntil(".jstree","li").each(function(n){if(f.max_depth!==-1&&f.max_depth-(n+1)<=0||(e=n===0?u:s._check(t,this,!1),e!==-1&&e-(n+1)<=0))return u=0,!1;e>=0&&(e-(n+1)<u||u<0)&&(u=e-(n+1)),f.max_depth>=0&&(f.max_depth-(n+1)<u||u<0)&&(u=f.max_depth-(n+1))}),u},check_move:function(){if(!this.__call_old())return!1;var t=this._get_move(),e=t.rt._get_settings().types,o=t.rt._check("max_children",t.cr),u=t.rt._check("max_depth",t.cr),f=t.rt._check("valid_children",t.cr),s=0,i=1,r;if(f==="none"||n.isArray(f)&&t.ot&&t.ot._get_type&&(t.o.each(function(){if(n.inArray(t.ot._get_type(this),f)===-1)return i=!1,!1}),i===!1)||e.max_children!==-2&&o!==-1&&(s=t.cr===-1?this.get_container().children("> ul > li").not(t.o).length:t.cr.children("> ul > li").not(t.o).length,s+t.o.length>o))return!1;if(e.max_depth!==-2&&u!==-1){if(i=0,u===0)return!1;if(typeof t.o.d=="undefined"){for(r=t.o;r.length>0;)r=r.find("> ul > li"),i++;t.o.d=i}if(u-t.o.d<0)return!1}return!0},create_node:function(t,i,r,u,f,e){if(!e&&(f||this._is_loaded(t))){var o=i&&i.match(/^before|after$/i)&&t!==-1?this._get_parent(t):this._get_node(t),s=this._get_settings().types,c=this._check("max_children",o),l=this._check("max_depth",o),h=this._check("valid_children",o),a;if(r||(r={}),h==="none")return!1;if(n.isArray(h))if(r.attr&&r.attr[s.type_attr]){if(n.inArray(r.attr[s.type_attr],h)===-1)return!1}else r.attr||(r.attr={}),r.attr[s.type_attr]=h[0];if(s.max_children!==-2&&c!==-1&&(a=o===-1?this.get_container().children("> ul > li").length:o.children("> ul > li").length,a+1>c)||s.max_depth!==-2&&l!==-1&&l-1<0)return!1}return this.__call_old(!0,t,i,r,u,f,e)}}})}(jQuery),function(n){n.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0),this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return this.nodeType==3}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(n,t,i){var r=this;this.load_node_html(n,function(){r.__callback({obj:n}),t.call(this)},i)},_is_loaded:function(n){return n=this._get_node(n),n==-1||!n||!this._get_settings().html_data.ajax||n.is(".jstree-open, .jstree-leaf")||n.children("ul").children("li").size()>0},load_node_html:function(t,i,r){var f,u=this.get_settings().html_data,e=function(){},o=function(){};if(t=this._get_node(t),t&&t!==-1){if(t.data("jstree-is-loading"))return;t.data("jstree-is-loading",!0)}switch(!0){case!u.data&&!u.ajax:t&&t!=-1||(this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;<\/ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node()),i&&i.call(this);break;case!!u.data&&!u.ajax||!!u.data&&!!u.ajax&&(!t||t===-1):t&&t!=-1||(f=n(u.data),f.is("ul")||(f=n("<ul>").append(f)),this.get_container().children("ul").empty().append(f.children()).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;<\/ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node()),i&&i.call(this);break;case!u.data&&!!u.ajax||!!u.data&&!!u.ajax&&t&&t!==-1:t=this._get_node(t),e=function(n,i,f){var e=this.get_settings().html_data.ajax.error;e&&e.call(this,n,i,f),t!=-1&&t.length?(t.children(".jstree-loading").removeClass("jstree-loading"),t.data("jstree-is-loading",!1),i==="success"&&u.correct_state&&t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")):i==="success"&&u.correct_state&&this.get_container().children("ul").empty(),r&&r.call(this)},o=function(r,f,o){var s=this.get_settings().html_data.ajax.success;if(s&&(r=s.call(this,r,f,o)),r=="")return e.call(this,o,f,"");r?(r=n(r),r.is("ul")||(r=n("<ul>").append(r)),t!=-1&&t?(t.children(".jstree-loading").removeClass("jstree-loading"),t.append(r).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;<\/ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),t.data("jstree-is-loading",!1)):this.get_container().children("ul").empty().append(r.children()).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;<\/ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node(t),i&&i.call(this)):t&&t!==-1?(t.children(".jstree-loading").removeClass("jstree-loading"),t.data("jstree-is-loading",!1),u.correct_state&&(t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),i&&i.call(this))):u.correct_state&&(this.get_container().children("ul").empty(),i&&i.call(this))},u.ajax.context=this,u.ajax.error=e,u.ajax.success=o,u.ajax.dataType||(u.ajax.dataType="html"),n.isFunction(u.ajax.url)&&(u.ajax.url=u.ajax.url.call(this,t)),n.isFunction(u.ajax.data)&&(u.ajax.data=u.ajax.data.call(this,t)),n.ajax(u.ajax)}}}}),n.jstree.defaults.plugins.push("html_data")}(jQuery),function(n){n.jstree.plugin("themeroller",{__init:function(){var t=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").delegate("a","mouseenter.jstree",function(){n(this).addClass(t.item_h)}).delegate("a","mouseleave.jstree",function(){n(this).removeClass(t.item_h)}).bind("open_node.jstree create_node.jstree",n.proxy(function(n,t){this._themeroller(t.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",n.proxy(function(){this._themeroller()},this)).bind("close_node.jstree",n.proxy(function(n,i){i.rslt.obj.children("ins").removeClass(t.opened).addClass(t.closed)},this)).bind("select_node.jstree",n.proxy(function(n,i){i.rslt.obj.children("a").addClass(t.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",n.proxy(function(){this.get_container().find("."+t.item_a).removeClass(t.item_a).end().find(".jstree-clicked").addClass(t.item_a)},this)).bind("move_node.jstree",n.proxy(function(n,t){this._themeroller(t.rslt.o)},this))},__destroy:function(){var i=this._get_settings().themeroller,t=["ui-icon"];n.each(i,function(n,i){i=i.split(" "),i.length&&(t=t.concat(i))}),this.get_container().removeClass("ui-widget-content").find("."+t.join(", .")).removeClass(t.join(" "))},_fn:{_themeroller:function(n){var t=this._get_settings().themeroller;n=!n||n==-1?this.get_container():this._get_node(n).parent(),n.find("li.jstree-closed > ins.jstree-icon").removeClass(t.opened).addClass("ui-icon "+t.closed).end().find("li.jstree-open > ins.jstree-icon").removeClass(t.closed).addClass("ui-icon "+t.opened).end().find("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon "+t.item_icon)}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_icon:"ui-icon-folder-collapsed"}}),n(function(){n.vakata.css.add_sheet({str:".jstree .ui-icon { overflow:visible; } .jstree a { padding:0 2px; }"})})}(jQuery),function(n){n.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",n.proxy(function(t,i){var u=[],f=!0,r,e;return i.func=="move_node"&&i.args[4]===!0&&i.args[0].o&&i.args[0].o.length&&(i.args[0].o.children("a").each(function(){u.push(n(this).text().replace(/^\s+/g,""))}),f=this._check_unique(u,i.args[0].np.find("> ul > li").not(i.args[0].o))),i.func=="create_node"&&(i.args[4]||this._is_loaded(i.args[0]))&&(r=this._get_node(i.args[0]),i.args[1]&&(i.args[1]==="before"||i.args[1]==="after")&&(r=this._get_parent(i.args[0]),r&&r!==-1||(r=this.get_container())),typeof i.args[2]=="string"?u.push(i.args[2]):i.args[2]&&i.args[2].data?u.push(i.args[2].data):u.push(this._get_settings().core.strings.new_node),f=this._check_unique(u,r.find("> ul > li"))),i.func=="rename_node"&&(u.push(i.args[1]),e=this._get_node(i.args[0]),r=this._get_parent(e),r&&r!==-1||(r=this.get_container()),f=this._check_unique(u,r.find("> ul > li").not(e))),f?void 0:(t.stopPropagation(),!1)},this))},_fn:{_check_unique:function(t,i){var r=[];return(i.children("a").each(function(){r.push(n(this).text().replace(/^\s+/g,""))}),!r.length||!t.length)?!0:(r=r.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),r.length+t.length!=r.concat(t).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length)?!1:!0},check_move:function(){if(!this.__call_old())return!1;var t=this._get_move(),i=[];return t.o&&t.o.length?(t.o.children("a").each(function(){i.push(n(this).text().replace(/^\s+/g,""))}),this._check_unique(i,t.np.find("> ul > li").not(t.o))):!0}}})}(jQuery);
//@ sourceMappingURL=jquery.jstree.min.js.map